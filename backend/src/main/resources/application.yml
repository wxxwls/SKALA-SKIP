spring:
  application:
    name: skip

  profiles:
    active: ${SPRING_PROFILE:dev}

  output:
    ansi:
      enabled: ${SPRING_OUTPUT_ANSI_ENABLED:always}

  datasource:
    url: ${DB_URL:jdbc:postgresql://localhost:5432/esgdb}
    username: ${DB_USERNAME:postgres}
    password: ${DB_PASSWORD:password}
    driver-class-name: org.postgresql.Driver
    hikari:
      maximum-pool-size: ${DB_POOL_SIZE:10}
      minimum-idle: ${DB_POOL_MIN_IDLE:5}
      connection-timeout: ${DB_CONNECTION_TIMEOUT:30000}
      idle-timeout: ${DB_IDLE_TIMEOUT:600000}
      max-lifetime: ${DB_MAX_LIFETIME:1800000}

  jpa:
    database-platform: org.hibernate.dialect.PostgreSQLDialect
    show-sql: ${JPA_SHOW_SQL:false}
    hibernate:
      ddl-auto: ${JPA_DDL_AUTO:validate}
    properties:
      hibernate:
        format_sql: ${JPA_FORMAT_SQL:false}
        use_sql_comments: ${JPA_SQL_COMMENTS:false}
        default_batch_fetch_size: ${JPA_BATCH_SIZE:100}

  flyway:
    enabled: ${FLYWAY_ENABLED:false}
    baseline-on-migrate: ${FLYWAY_BASELINE:true}
    locations: classpath:db/migration
    encoding: UTF-8
    schemas: ${FLYWAY_SCHEMA:skala7_skip_dev}
    default-schema: ${FLYWAY_SCHEMA:skala7_skip_dev}

  data:
    redis:
      host: ${REDIS_HOST:localhost}
      port: ${REDIS_PORT:6379}
      password: ${REDIS_PASSWORD:}
      timeout: ${REDIS_TIMEOUT:3000}
      lettuce:
        pool:
          max-active: ${REDIS_POOL_MAX_ACTIVE:8}
          max-idle: ${REDIS_POOL_MAX_IDLE:8}
          min-idle: ${REDIS_POOL_MIN_IDLE:0}

  security:
    oauth2:
      resourceserver:
        jwt:
          issuer-uri: ${JWT_ISSUER_URI:}

  servlet:
    multipart:
      max-file-size: ${MAX_FILE_SIZE:10MB}
      max-request-size: ${MAX_REQUEST_SIZE:10MB}

# Application Configuration
app:
  security:
    jwt-secret: ${JWT_SECRET}
    jwt-expiration: ${JWT_EXPIRATION:3600000}
    jwt-refresh-expiration: ${JWT_REFRESH_EXPIRATION:604800000}

  fastapi:
    base-url: ${FASTAPI_BASE_URL:http://localhost:8000}
    timeout: ${FASTAPI_TIMEOUT:30000}
    retry-count: ${FASTAPI_RETRY_COUNT:3}

  ai-service:
    base-url: ${AI_SERVICE_URL:http://localhost:8000}
    timeout: ${AI_SERVICE_TIMEOUT:120000}
    max-in-memory-size: ${AI_SERVICE_MAX_MEMORY:16777216}

  aws:
    s3:
      access-key-id: ${AWS_ACCESS_KEY_ID:}
      access-key: ${AWS_ACCESS_KEY:}
      region: ${AWS_REGION:ap-northeast-2}
      access-point-arn: ${AWS_S3_ACCESS_POINT_ARN:}
      access-point-url: ${AWS_S3_ACCESS_POINT_URL:}
      access-point-name: ${AWS_S3_ACCESS_POINT_NAME:}
      account-id: ${AWS_ACCOUNT_ID:}

  issue-pool:
    max-topic-count: 20

  stakeholder-survey:
    required-issue-count: 5
    min-score: 1
    max-score: 3

  news:
    retention-years: 2

# Actuator Configuration
management:
  endpoints:
    web:
      exposure:
        include: ${ACTUATOR_ENDPOINTS:health,info,metrics,prometheus}
      base-path: /actuator
  endpoint:
    health:
      show-details: ${ACTUATOR_HEALTH_DETAILS:when-authorized}
  metrics:
    export:
      prometheus:
        step: ${PROMETHEUS_STEP:1m}
  prometheus:
    metrics:
      export:
        enabled: ${PROMETHEUS_ENABLED:true}

# Logging Configuration
logging:
  level:
    root: ${LOG_LEVEL_ROOT:INFO}
    com.skala.skip: ${LOG_LEVEL_APP:INFO}
    org.springframework.web: ${LOG_LEVEL_SPRING_WEB:INFO}
    org.springframework.security: ${LOG_LEVEL_SPRING_SECURITY:INFO}
    org.hibernate.SQL: ${LOG_LEVEL_HIBERNATE_SQL:INFO}
    org.hibernate.type.descriptor.sql.BasicBinder: ${LOG_LEVEL_HIBERNATE_BINDER:INFO}
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n"
    file: "%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n"
  logback:
    rollingpolicy:
      file-name-pattern: ${LOG_FILE_NAME:logs/skip.log}.%d{yyyy-MM-dd}.%i.gz
      max-file-size: ${LOG_FILE_MAX_SIZE:10MB}
      max-history: ${LOG_FILE_MAX_HISTORY:30}
      total-size-cap: ${LOG_FILE_TOTAL_SIZE_CAP:1GB}

# SpringDoc OpenAPI Configuration
springdoc:
  api-docs:
    path: /api-docs
    enabled: ${SPRINGDOC_ENABLED:true}
  swagger-ui:
    path: /swagger-ui.html
    enabled: ${SWAGGER_UI_ENABLED:true}
    operations-sorter: alpha
    tags-sorter: alpha
  show-actuator: false
